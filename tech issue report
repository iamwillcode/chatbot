A) SharePoint list (new)

Create a list (e.g., Channel Issues (Weekly)) with these columns:

Affected user name â€” Single line of text

User UPN â€” Single line of text

Agent Name â€” Person or Group (single selection)

Issue â€” Multiple lines of text

Date reported â€” Date and Time (Include time)

Link to user message â€” Hyperlink (show as hyperlink)

(You can add more later; these are the ones your team asked for.)

B) Power Automate â€” Flow (Teams â†’ SharePoint â†’ Adaptive Card)
0) Trigger

Microsoft Teams â†’ When a new channel message is added (V3)

Team: (the team with the user-facing channel)

Channel: (e.g., Anita)

1) Initialize variables

Add 6 Initialize variable actions:

varMessageLink â€” String â€” (blank)

varAffectedUser â€” String â€” (blank)

varAffectedUserUPN â€” String â€” (blank)

varIssueText â€” String â€” (blank)

varListItemId â€” String â€” (blank)

varWithinWindow â€” Boolean â€” false

2) Get message details

Microsoft Teams â†’ Get message details (V3)

Message ID: Message ID (from trigger)

Team/Channel: same as trigger

Then:

Set variable varMessageLink = Link to message (from Get message details)

Set variable varAffectedUser = From Display Name (from Get message details)

3) Extract the posterâ€™s UPN (User UPN)

Try direct (many tenants expose it):

Set variable varAffectedUserUPN = Expression

outputs('Get_message_details_(V3)')?['from']?['user']?['userPrincipalName']


If that returns blank in your run history, add:

Office 365 Users â†’ Search for users (V2)

Search term: From Display Name (from Get message details)

Condition: if length(body('Search_for_users_(V2)')?['value']) > 0

True â†’ Set variable varAffectedUserUPN =

first(body('Search_for_users_(V2)')?['value'])?['userPrincipalName']


False â†’ leave as blank

(Office 365 Users is a standard connector.)

4) Build the Issue text (message body â†’ clean fallback)

Add two Compose actions:

Compose â€” RawBody = Body (from Get message details)

Compose â€” IssueText (Expression):

if(
  not(empty(outputs('Compose_-_RawBody'))),
  outputs('Compose_-_RawBody'),
  '(no message text)'
)


Then Set variable varIssueText = Outputs of Compose â€” IssueText.

If your message body includes <br> and HTML, you can lightly clean it with:

replace(replace(outputs('Compose_-_IssueText'),'<br>','\n'),'<br/>','\n')

5) Respect your weekly window (Saturday 12:00 AM â†’ Friday 11:59 PM, Toronto)

Weâ€™ll calculate the current weekâ€™s start (Saturday 00:00) and ensure the message timestamp falls within [weekStart, weekStart+7d) in America/Toronto.

Add three Compose actions:

Compose â€” LocalNow (Expression):

convertTimeZone(utcNow(),'UTC','Eastern Standard Time')


Compose â€” WeekStartLocal (Expression):

addDays(
  startOfDay(outputs('Compose_-_LocalNow')),
  -mod(add(dayOfWeek(outputs('Compose_-_LocalNow')),1),7)
)


(This backs up to the most recent Saturday 00:00.)

Compose â€” CreatedLocal (Expression):

convertTimeZone(triggerOutputs()?['body/createdDateTime'],'UTC','Eastern Standard Time')


Now add a Condition (single Expression) to set the flag:

and(
  greaterOrEquals(outputs('Compose_-_CreatedLocal'), outputs('Compose_-_WeekStartLocal')),
  less(outputs('Compose_-_CreatedLocal'), addDays(outputs('Compose_-_WeekStartLocal'),7))
)


True â†’ Set variable varWithinWindow = true

False â†’ (do nothing)

Add another Condition to exit early if outside window:

Expression: equals(variables('varWithinWindow'), true)

True â†’ continue

False â†’ Terminate (Status = Succeeded; Message = â€œOutside weekly windowâ€)

That implements your â€œrun from Saturday midnight to Friday 11:59 PMâ€ requirement using the messageâ€™s timestamp in the Toronto timezone.

6) Create the SharePoint list item

SharePoint â†’ Create item

Site: your site

List: your new list

Map fields:

Affected user name â†’ variables('varAffectedUser')

User UPN â†’ variables('varAffectedUserUPN')

Issue â†’ variables('varIssueText')

Date reported â†’ Expression convertTimeZone(triggerOutputs()?['body/createdDateTime'],'UTC','Eastern Standard Time')

Link to user message (Hyperlink) â†’

Url = variables('varMessageLink')

Description = Open Teams message

Agent Name â†’ (leave blank here; weâ€™ll set it when a tech clicks the button)

Then Set variable varListItemId = ID (from Create item).

7) Post the Adaptive Card to your support chat (and wait)

Weâ€™ll send a simple card (v1.4) with View message, Open List Item, and Work in Progress. If your action only shows a single Message box, use an Expression that builds JSON.

Compose â€” ListItemUrl (Expression):

concat('https://<yourtenant>.sharepoint.com/sites/<YourSite>',
       '/Lists/Channel%20Issues%20(Weekly)/EditForm.aspx?ID=',
       variables('varListItemId'))


(Adjust the site and list path; URL-encode spaces with %20.)

Microsoft Teams â†’ Post adaptive card and wait for a response

Post as: Flow bot

Post in: Group chat: (your tech support chat)

Message (Expression, safe v1.4 minimal card):

concat(
'{',
'"$schema":"http://adaptivecards.io/schemas/adaptive-card.json",',
'"type":"AdaptiveCard","version":"1.4",',
'"body":[',
  '{ "type":"TextBlock","text":"New channel issue","weight":"Bolder","size":"Medium" },',
  '{ "type":"TextBlock","text":"From: ', variables('varAffectedUser') , '","wrap":true },',
  '{ "type":"TextBlock","text":"Issue:","weight":"Bolder" },',
  '{ "type":"TextBlock","text":"', replace(variables('varIssueText'),'"','\"') , '","wrap":true }',
'],',
'"actions":[',
  '{ "type":"Action.OpenUrl","title":"ğŸ”— View message","url":"', variables('varMessageLink') ,'" },',
  '{ "type":"Action.OpenUrl","title":"ğŸ“ Open List Item","url":"', outputs('Compose_-_ListItemUrl') ,'" },',
  '{ "type":"Action.Submit","title":"ğŸ› ï¸ Work in Progress","data":{"action":"assignToMe","listItemId":"', variables('varListItemId') ,'"} }',
']',
'}'
)


If you see â€œinvalid cardâ€, double-check quotes and your step names. You can also build the card in a Compose and set Message = Outputs.

8) On click â†’ set Agent Name automatically + notify

Rename the Adaptive Card step to Post_card_Support (â€¦ â†’ Rename) to make expressions tidy.

Add a Condition (Expression):

equals(
  coalesce(
    outputs('Post_card_Support')?['body']?['data']?['action'],
    outputs('Post_card_Support')?['data']?['action'],
    outputs('Post_card_Support')?['body']?['submitActionId'],
    outputs('Post_card_Support')?['submitActionId']
  ),
  'assignToMe'
)


True branch:

SharePoint â†’ Update item

ID: variables('varListItemId')

Agent Name (Person) = Expression (claims):

concat(
  'i:0#.f|membership|',
  outputs('Post_card_Support')?['body']?['responder']?['userPrincipalName']
)


(If your tenant accepts UPN directly for Person: use the UPN path without the concat.)

Teams â†’ Post message (support chat):

ğŸ› ï¸ @{outputs('Post_card_Support')?['body']?['responder']?['displayName']} is working on the issue.
ğŸ”— Original: @{variables('varMessageLink')}


Teams â†’ Reply with a message in the channel (Message ID from trigger):

ğŸ› ï¸ A technician is now working on your issue. Weâ€™ll keep you updated!


False branch: do nothing.

That last question you asked

â€œCan this automation automatically capture the agent that worked on the issue name?â€

âœ… Yes. Thatâ€™s exactly what Step 8 does. When a tech clicks â€œWork in Progressâ€ on the Adaptive Card, the flow records that techâ€™s display name/UPN into the Agent Name (Person) column for that list item.

C) Quick test plan (5 minutes)

Post a test message in the channel (with text).

Flow creates a row in your new list with:

Affected user name â€” filled

User UPN â€” filled (or blank if directory didnâ€™t return; see step 3 above)

Issue â€” the message text

Date reported â€” the messageâ€™s timestamp (Toronto)

Link to user message â€” the Teams deep link

Card lands in your tech chat with View message, Open List Item, Work in Progress.

Click Work in Progress â†’ Agent Name fills on the list; notifications post.

Troubleshooting cheatsheet

Create item fails â†’ a column type mismatch (e.g., Issue must be text/multiline).

UPN blank â†’ your tenantâ€™s Teams payload didnâ€™t include it; keep the Office 365 Users fallback.

Card click not detected â†’ ensure the action is Post adaptive card and wait for a response, version 1.4 in JSON, and your Condition uses the coalesce(...) path above.

Window filter wrong â†’ open a run and check the three composes (LocalNow, WeekStartLocal, CreatedLocal) to confirm values; adjust timezone if needed.

If you paste your site URL and the exact list name you used, I can give you the precise ListItemUrl expression (with the right %20 encodes) so you can paste it as-is.
